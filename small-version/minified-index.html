<html>
<body>
<input id="fileInput" type="file">
<button id="convertToObj">Convert</button>
<input id="tCOverride" placeholder="tco">
<script>
class simpleView{constructor(t){this.view=new DataView(t),this.vO=0}x(){let t=this.l(),e=this.view.buffer.slice(this.vO,this.vO+t),n=(new TextDecoder).decode(e);return this.vO+=t,n}f3(){let t=this.view.getFloat32(this.vO,!0);return this.vO+=4,t}fq(){let t=this.view.getInt32(this.vO,!0);return this.vO+=4,t}l(){let t=this.view.getUint32(this.vO,!0);return this.vO+=4,t}k(){let t=this.view.getUint16(this.vO,!0);return this.vO+=2,t}q(){let t=this.view.getUint8(this.vO);return this.vO+=1,t}}function SEMStoJSON(t){let e={mCount:0,mes:[]},n=new Uint8Array(t);if(83==n[0]&&69==n[1]&&77==n[2]&&83==n[3]){let n=new simpleView(t);n.vO=12,e.mCount=n.q(),n.vO+=3;for(let t=0;t<e.mCount;t++){let t={vC:0,z:0,tc:0,v:[],vn:[],vt:[],i:[],tH:{},bb:[],t1e:!1,t2e:!1,t3e:!1,t4e:!1};n.vO+=12;let i={x:-n.f3(),y:n.f3(),z:n.f3()};t.bb.push(i);let l={x:-n.f3(),y:n.f3(),z:n.f3()};t.bb.push(l),n.vO+=12;let s=n.fq();-8421505==s?(t.tc=1,t.t1e=!0):-8355712==s?(t.tc=3,t.t1e=!0,t.t2e=!0,t.t3e=!0):t.tc=3,n.vO+=16;for(let e=0;e<4;e++)if(t["t"+(e+1)+"e"]){e>0&&(n.vO+=3),n.vO+=1;let i=n.x();t.tH[e]=i,n.vO+=3}n.vO+=62-t.tc,t.vC=n.l();for(let e=0;e<t.vC;e++)t.v.push({x:-n.f3(),y:n.f3(),z:n.f3()}),t.vn.push({x:-n.f3(),y:n.f3(),z:n.f3()}),n.vO+=4,t.vt.push({x:n.f3(),y:-n.f3()});t.z=n.fq()/3;for(let e=0;e<t.z;e++){let e=[n.k(),n.k(),n.k()];e=[e[2]+1,e[1]+1,e[0]+1],t.i.push(e)}e.mes.push(t)}}return e}function JSONtoOBJ(t){let e="mtllib m.mtl",n="",i=0;for(let l=0;l<t.mes.length;l++){let s=t.mes[l];if(n+="\nnewmtl m"+l,n+="\nillum 4\nKd 0.0 0.0 0.0\nKa 0.0 0.0 0.0\nTf 1.0 1.0 1.0\nNi 1.0\nKs 0.0 0.0 0.0",s.t1e){n+="\nmap_Kd "+s.tH[0].split("/")[s.tH[0].split("/").length-1]}if(s.t2e){n+="\nbump  -bm 1 "+s.tH[1].split("/")[s.tH[1].split("/").length-1]}if(s.t3e){n+="\nmap_Ks "+s.tH[2].split("/")[s.tH[2].split("/").length-1]}e+="\nusemtl m"+l;for(let t=0;t<s.vC;t++){let n=s.v[t],i=s.vn[t],l=s.vt[t];e+="\nv "+n.x+" "+n.y+" "+n.z,e+="\nvn "+i.x+" "+i.y+" "+i.z,e+="\nvt "+l.x+" "+l.y}for(let t=0;t<s.z;t++){let n=s.i[t][0]+i,l=s.i[t][1]+i,v=s.i[t][2]+i;e+=`\nf ${n}/${n}/${n} ${l}/${l}/${l} ${v}/${v}/${v}`}i+=s.i.length}return{obj:e,mtl:n}}let fI=document.getElementById("fileInput");function Ds(t,e){let n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}document.getElementById("convertToObj").addEventListener("click",(function(){let t=fI.files[0];!async function(){let e=JSONtoOBJ(SEMStoJSON(await t.arrayBuffer()));Ds(t.name+".obj",e.obj),Ds(t.name+".mtl",e.mtl)}()}));
</script>
</body>
</html>